<div class="board-container" cdkScrollable>
    <app-dashboard-info-panel [title]="projectName + ' » ' + boardName">
        <button back class="back-btn" (click)="goBack()">
            <span class="material-icons">chevron_left</span>
        </button>

        <div back class="proj-short">{{ getShortName(projectName) }}</div>

        <div content-right>
            <app-link-button (action)="onClickOpenAddMember()" title="Add Members" buttonClass="create-project-button"
                icon="person_add">
            </app-link-button>

            <app-link-button (action)="openManageMembers()" title="Manage Members" buttonClass="create-project-button"
                icon="manage_accounts">
            </app-link-button>
        </div>

        <div title-actions>
            <app-link-button (action)="onClickOpenAddList()" title="Add List" buttonClass="create-new-project-button"
                icon="playlist_add">
            </app-link-button>
        </div>

        <div class="board-members" content-left>
            <span class="members-label">Board Members:</span>
            <div class="members-list overlap">
                @for (member of allBoardMembers(); track $index)
                {
                <div class="member-circle">
                    {{ getShortName(member.full_name) }}
                </div>
                }
            </div>
        </div>
    </app-dashboard-info-panel>


    @if(showAddMemberModel()){
    <app-model-view class="management-model" (closeModel)="onClickOpenAddMember()">
        <app-reactive-form title=" Add New Member" p="Add a new member to start organizing your work"
            buttonName="Add member" [formData]="formData()" (submittedData)="addBoardMember($event)"
            formClass="management-form-class" titleIcon="add" (change)="onChangeSelect($event)">
            <p class="project-level-info">
                This is a board-level role. The member will have access only to this board and not to any other boards
                in the project.
            </p>


            @if (selectedRole()) {
            <div class="role-info">
                <p class="role-detail">
                    <strong class="role-name">
                        {{ selectedRole().replace('_', ' ') | titlecase }}
                    </strong>
                    — {{ selectedRoleDescription() }}
                </p>
            </div>
            }

        </app-reactive-form>
    </app-model-view>
    }

    <app-board-lists [lists]="lists()" [boardMembers]="allBoardMembers()"
        (refresh)="loadBoardLists()"></app-board-lists>

    @if (showManageMemberModel()) {
    <app-model-view class="management-model" (closeModel)="openManageMembers()">
        <app-manage-roles [manageRolesData]="manageRolesData()" [roles]="boardRoles()"
            (deleteMember)="deleteMemberShip($event)" (saveRole)="onNewRole($event)"
            headerTitle="Board Members Management" headerDescription="Control who can access and manage this board.
            Update roles, adjust permissions, or remove members." searchPlaceholder="Search by email" context="board">
        </app-manage-roles>
    </app-model-view>
    }

    @if (showaddListModel()) {
    <app-model-view class="management-model" (closeModel)="onClickOpenAddList()">
        <app-reactive-form title="Add New List" p="Create a new list for this board to help organize your tasks."
            buttonName="Create List" [formData]="listFormData()" (submittedData)="addNewList($event)"
            formClass="management-form-class" titleIcon="playlist_add">
        </app-reactive-form>
    </app-model-view>
    }
    <app-confirm-delete [show]="showDeleteCardModal()" title="Delete Card"
        message="Are you sure you want to delete this card?" (close)="handleDeleteCard($event)">
    </app-confirm-delete>

    <app-confirm-delete [show]="showDeleteModal()" title="Delete List"
        message="Are you sure you want to delete this list?" (close)="handleDelete($event)">
    </app-confirm-delete>
</div>